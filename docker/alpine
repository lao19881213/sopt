FROM alpine:3.4
ADD docker/repositories /etc/apk/repositories
RUN apk add --update gcc g++ gfortran cmake tiff-dev fftw-dev git curl make
RUN apk add --update glibc glibc-headers
RUN apk add --update python3 python3-dev && \
    python3 -m ensurepip && \
    pip3 install --upgrade pip setuptools && \
    pip3 install numpy scipy pandas pytest
# Grsec forbids running /usr/bin/ar somehow...
# Removing it is simpler and less secure
RUN apk del linux-grsec
WORKDIR /tmp
ADD docker/install_eigen.sh /tmp/install_eigen.sh
RUN sh /tmp/install_eigen.sh
VOLUME /code
RUN mkdir -p /code/build_alpine
WORKDIR /code/build_alpine
